var STARZ=STARZ||{},UI=UI||{};STARZ.Achievement={},STARZ.Achievement.SavedTV={name:"Screen Saver",detail:"Save at least 20 TVs."},STARZ.Achievement.BrokenTV={name:"It Was Working a Minute Ago...",detail:"Break at least 10 TVs."},STARZ.Achievement.RightAnswer={name:"Head of the Class",detail:"Answer at least one quiz question correctly."},STARZ.Achievement.WrongAnswer={name:"Studying is Overrated",detail:"Answer at least one quiz question incorrectly."},STARZ.Achievement.Clicks={name:"I Can't Feel My Fingers",detail:"Change 100 channels or more."},STARZ.Achievement.GameComplete={name:"Control Freak",detail:"Complete the InControl Game."},STARZ.GameStatusManager=function(){function a(a,b){switch(a){case"score":f.score+=b;break;case"bonus":f.score+=b,f.bonusCount+=1;break;case"correct":f.correct++,f.score+=STARZ.Scores.Correct;break;case"incorrect":f.incorrect++,f.score+=STARZ.Scores.Incorrect;break;case"completedTV":f.completedTV++,f.score+=STARZ.Scores.CompletedTV,f.completedTV>20&&STARZ.EventDispatcher.fire("achievementEvent",STARZ.Achievement.SavedTV);break;case"brokenTV":f.brokenTV++,f.score+=STARZ.Scores.BrokenTV,f.brokenTV>10&&STARZ.EventDispatcher.fire("achievementEvent",STARZ.Achievement.BrokenTV);break;case"achievement":-1===f.achievements.indexOf(b)&&f.achievements.push(b)}}function b(){return f}function c(){f={score:0,correct:0,incorrect:0,completedTV:0,bonusCount:0,brokenTV:0,achievements:[],currentRound:0,totalRounds:3}}function d(){document.addEventListener("tvEvent",e),document.addEventListener("quizEvent",e),document.addEventListener("gameEvent",e),document.addEventListener("achievementEvent",e)}function e(b){var c=b.type,d=b.detail;switch(c){case"gameEvent":"roundComplete"===d&&f.currentRound++;break;case"tvEvent":"complete"===d&&STARZ.GameStatusManager.store("completedTV"),"broken"===d&&STARZ.GameStatusManager.store("brokenTV"),"bonus"===d.type&&STARZ.GameStatusManager.store("bonus",d.value);break;case"quizEvent":"correct"===d&&STARZ.GameStatusManager.store("correct"),"incorrect"===d&&STARZ.GameStatusManager.store("incorrect");break;case"achievementEvent":a("achievement",d)}}var f;return d(),{reset:c,store:a,data:b}}(),STARZ.QuizManager=function(){function a(a){f=a}function b(a){UI.ButtonFX.cleanup(".buttonOptions"),d(),g=g||$("[data-question]:eq(0)"),h=h||$("[data-answers]:eq(0)"),j=j||$("[data-feedback]:eq(0)"),k=k||p.find(".buttonOptions"),k.hide();var b=f.questions[o];g.text(b.question);for(var l=0;l<b.answers.length;l++){var q=b.answers[l].answer,r=b.answers[l].correct;1===r&&m++;var s="<"+a+'  class="lightMargin hotspot triviaButton default" data-answer data-correct="'+r+'">'+q+"</"+a+">";$(s).appendTo(h)}c(".triviaButton"),UI.ButtonFX.init(".triviaButton"),UI.ButtonFX.oneClick(".triviaButton"),i=$("[data-answer]"),i.click(function(){var a=$(this);a.unbind("click");var c=a.attr("data-correct");a.removeClass("default"),"1"===c?(STARZ.EventDispatcher.fire("achievementEvent",STARZ.Achievement.RightAnswer),a.addClass("correct"),n++,m>1&&m>n&&j.text("Keep going, there are more correct answers.")):(STARZ.EventDispatcher.fire("achievementEvent",STARZ.Achievement.WrongAnswer),a.addClass("incorrect"),e(b.incorrect,"incorrect")),n===m&&e(b.correct,"correct")}),o++,o===f.questions.length&&(o=0)}function c(a){var b=1,c=.4;$(a).each(function(){var a=$(this);TweenLite.from(a,.25,{y:30,opacity:0,delay:b*c}),b++,UI.ButtonFX.setState(a,b*c*1e3)})}function d(){m=0,n=0,$("[data-answer]").removeClass("correct incorrect"),g&&(g.empty(),i.remove(),j.empty())}function e(a,b){void 0!=i&&i.unbind("click"),j.text(a),STARZ.EventDispatcher.fire("quizEvent",b),UI.ButtonFX.cleanup(".triviaButton"),UI.ButtonFX.init(".buttonOptions"),l=p.find(".next"),l.fadeTo("slow",1),TweenLite.from(l,.25,{x:100})}var f,g,h,i,j,k,l,m,n,o=0,p=$("#triviaScreen");return{data:a,build:b,questions:function(){return f.sets}}}(),STARZ.ScreenManager=function(){function a(a){var c=a.detail;b(c)}function b(a){f?f.stop().fadeTo(g,0,function(){f.hide(),c(a)}):c(a)}function c(a){f=$(a),e(a),f.stop().fadeTo(g,1)}function d(a,b,c){var d={screen:a,method:b,argument:c};h.methods.push(d)}function e(a){for(var b=0;b<h.methods.length;b++)if(h.methods[b].screen===a){h.methods[b].method(h.methods[b].argument);break}}var f,g=500,h={methods:[]};return document.addEventListener("navEvent",a),{showScreen:b,bindMethod:d}}(),STARZ.SoundManager=function(){function a(a){j=document.getElementById(a),j.style.display="none"}function b(a){m.push(document.getElementById(a))}function c(a){n.push(document.getElementById(a))}function d(a){l||(m[a].load(),m[a].play())}function e(a){k&&k.pause(),k=n[a],l||(n[a].load(),n[a].play())}function f(){k&&k.pause()}function g(a){l=a||!l,l?f():k&&k.play()}function h(){l=!0,f()}function i(){l=!1,k&&k.play()}var j,k,l=!1,m=[],n=[];return{init:a,addFX:b,addMusic:c,playFX:d,playMusic:e,stop:f,toggle:g,pause:h,resume:i}}(),STARZ.TVManager=function(){function a(a){j=a}function b(a){n.length<1&&$(a).each(function(){var a={el:$(this),starzImage:f(j.starz),images:h(j.generic),brokenImage:f(j.broken),bonusImage:g(j.bonus),finalImage:j.finalImage},b=STARZ.TV.create(a);document.addEventListener("tvEvent",i),n.push(b)}),c()}function c(){k=0,l=0;for(var a=0;a<n.length;a++)n[a].init()}function d(){for(var a=0;a<n.length;a++)n[a].start()}function e(){for(var a=0;a<n.length;a++)n[a].pause()}function f(a){var b=Math.floor(Math.random()*a.length);return b===a.length&&b--,a[b].image}function g(a){if(Math.ceil(Math.random()*m)===m){var b=Math.floor(Math.random()*a.length);return b===a.length&&b--,{image:a[b].image,value:a[b].value}}return null}function h(a){for(var b=Object.keys(a),c=[],d=0;d<b.length;d++)c.push(a[b[d]].image);return c}function i(a){switch(a.detail){case"broken":k++;break;case"complete":l++}k+l===n.length&&STARZ.EventDispatcher.fire("gameEvent","roundComplete")}var j,k,l,m=1,n=[];return{data:a,build:b,pause:e,start:d}}(),STARZ.Scores={},STARZ.Scores.CompletedTV=1e3,STARZ.Scores.BrokenTV=-500,STARZ.Scores.Correct=500,STARZ.Scores.Channel=10,STARZ.Scores.Incorrect=-250,STARZ.TV=function(){function a(a){return b(a)}var b=function(a){function b(){j(),w.push(x),d(),v.removeClass("broken1"),v.removeClass("broken2"),v.removeClass("broken3"),v.removeClass("broken4"),finalClick=!1,C=!1,F.hide(),H.hide()}function c(){if(E.complete(o),E.alert("0.7",e),null!=A){var a=Math.floor(Math.random()*(w.length-1));w.splice(a,0,A.image),B=A.value}k(),v.click(function(){i()})}function d(){var a=Math.floor(Math.random()*w.length);a===w.length&&a--,w[a]===D?d():(D=w[a],v.css({"background-image":"url(img/tv/"+D+")"}))}function e(){F.fadeTo("fast",1),new TweenLite(G,t,{width:"70%",rotation:"360",ease:Quad.easeOut})}function f(){F.fadeTo("slow",0,function(){$(this).hide()}),new TweenLite(G,t,{width:"20%",rotation:"0",ease:Quad.easeOut})}function g(){H.fadeTo("fast",1),new TweenLite(I,t,{width:"70%",ease:Quad.easeOut,onComplete:h}),STARZ.SoundManager.playFX(0)}function h(){H.fadeTo("slow",0,function(){$(this).hide()}),new TweenLite(I,t,{width:"20%",ease:Quad.easeOut})}function i(){C||(D===x?p():A&&D===A.image&&(STARZ.EventDispatcher.fire("tvEvent",{type:"bonus",value:B}),g(),d()))}function j(){E.reset()}function k(){C=!1,E.start(),m()}function l(){C=!0,E.stop(),n()}function m(){s=setInterval(d,u)}function n(){clearInterval(s)}function o(){q();var a=Math.floor(4*Math.random());switch(a){case 0:v.addClass("broken1");break;case 1:v.addClass("broken2");break;case 2:v.addClass("broken3");break;case 3:v.addClass("broken4");break;default:v.addClass("broken1")}v.css({"background-image":"url(img/tv/"+z+")"}),STARZ.EventDispatcher.fire("tvEvent","broken"),STARZ.SoundManager.playFX(0)}function p(){E.stop(),n(),q(),v.css({"background-image":"url(img/tv/"+y+")"}),STARZ.EventDispatcher.fire("tvEvent","complete"),STARZ.SoundManager.playFX(1)}function q(){E.reset(),n(),f(),r()}function r(){v.unbind("click")}var s,t=.5,u=Math.round(4e3*Math.random())+2e3,v=a.el,w=a.images,x=a.starzImage,y=a.finalImage,z=a.brokenImage,A=a.bonusImage,B=0,C=!1,D="",E=STARZ.Timer.create(v.children(".timer:eq(0)")),F=v.children(".alert:eq(0)"),G=F.children(".animate:eq(0)"),H=v.children(".bonus:eq(0)"),I=H.children(".animate:eq(0)");return{init:b,start:c,pause:l}};return{create:a}}(),STARZ.Timer=function(){function a(a){return c(a)}var b=15,c=function(a){function c(){j?j.play():j=new TweenLite(n,m,{width:"80%",ease:Linear.easeNone,onComplete:h})}function d(){j&&j.pause()}function e(){j&&j.restart()}function f(){j=null,n.css("width","0")}function g(a,b){l=setInterval(function(){j&&j.progress()>=a&&b()},1e3)}function h(){clearInterval(l),k()}function i(a){k=a}var j,k,l,m=Math.round(Math.random()*b)+b,n=a;return{start:c,stop:d,reset:f,restart:e,complete:i,alert:g}};return{create:a}}(),STARZ.Game=function(){function a(){f.fadeTo("fast",1),g.hide(),UI.Dimmer.reset(),UI.Dimmer.show(.4),setTimeout(b,e),STARZ.TVManager.build(".tvScreen"),STARZ.SoundManager.stop()}function b(){f.fadeTo("fast",0,function(){$(this).hide()}),STARZ.SoundManager.playMusic(1),STARZ.TVManager.start()}function c(){g.delay(2e3).fadeTo("fast",1),UI.Dimmer.hide(1e3),STARZ.SoundManager.stop()}function d(a){switch(a.detail){case"roundComplete":c()}}var e=2e3,f=$("#ready"),g=$("#complete");return document.addEventListener("gameEvent",d),{init:a}}(),STARZ.Instructions=function(){function a(){UI.Dimmer.contract(80),UI.Dimmer.show(.4),c?c.reset():b()}function b(){c=UI.Slideshow.build("#instructions",".wrapper",".item",".prev",".next")}var c;return{init:a}}(),STARZ.Quiz=function(){function a(){switch(j.addClass("next"),h.removeClass("next"),i.removeClass("next"),d=d||STARZ.GameStatusManager.data(),e=STARZ.QuizManager.questions(),d.currentRound){case 1:g=e[0].round1;break;case 2:g=e[0].round2;break;case 3:g=e[0].round3;break;default:g=e[0].round1}f=0,UI.Dimmer.contract(80),UI.Dimmer.show(.4),c()}function b(){f++,f===g&&(d.currentRound===d.totalRounds?(j.removeClass("next"),i.addClass("next")):(j.removeClass("next"),h.addClass("next")))}function c(){STARZ.QuizManager.build("span")}var d,e,f,g,h=$('[data-screen="#gameplayScreen"]'),i=$('[data-screen="#summaryScreen"]'),j=$('[data-method="nextQuestion"]');return document.addEventListener("quizEvent",b),j.click(function(){c()}),{init:a}}(),STARZ.Summary=function(){function a(){STARZ.EventDispatcher.fire("achievementEvent",STARZ.Achievement.GameComplete),c=c||$("[data-stat-broken]"),d=d||$("[data-stat-completed]"),e=e||$("[data-stat-score]"),g=g||$("[data-stat-bonuscount]"),f=f||$("[data-stat-correct]"),h=h||$("[data-stat-incorrect]"),i=i||$("#achievements"),j=STARZ.GameStatusManager.data(),b(),UI.Dimmer.contract(80),UI.Dimmer.show(.4)}function b(){c.text(j.brokenTV),d.text(j.completedTV),e.text(j.score),g.text(j.bonusCount),f.text(j.correct),h.text(j.incorrect);var a="";i.empty();for(var b=0;b<j.achievements.length;b++)a+='<span class="achievement"><strong class="ltBlue">'+j.achievements[b].name+"</strong><br><em>"+j.achievements[b].detail+"</em></span><br>";$(a).appendTo(i)}var c,d,e,f,g,h,i,j;return{init:a}}(),STARZ.Title=function(){function a(){STARZ.GameStatusManager.reset(),STARZ.SoundManager.playMusic(0),UI.Dimmer.hide(),UI.ToggleButton.init("#volumeToggle","[data-toggle-on]","[data-toggle-off]",STARZ.SoundManager.toggle,!0),$(".toggleButton").fadeTo("fast",1),UI.VideoPlayer.playVideo("http://www.starz.com/videos/html5/the_white_queen_27014.mp4")}return{init:a}}(),UI.ButtonFX=function(){function a(a){var b=$(a);b.stop().css("opacity",f),b.hover(function(){$(this).stop().fadeTo("fast",1)},function(){$(this).stop().fadeTo("fast",f)})}function b(a){var b=$(a);b.click(function(){c($(this))})}function c(a){var b=$(a);b.stop().unbind("mouseenter mouseleave")}function d(a,b){b?setTimeout(function(){e(a)},b):e(a)}function e(a){a.stop().fadeTo("fast",f)}var f=.6;return{init:a,oneClick:b,cleanup:c,setState:d}}(),UI.Dimmer=function(){function a(){g.css({height:window.innerHeight+"px"})}function b(a){var b=a||1;g.fadeTo(500,b)}function c(a){var b=a||0;g.delay(b).fadeTo(500,0,function(){$(this).hide()})}function d(a){var b=(100-a)/2;g.css({left:b+"%",width:a+"%"})}function e(){g.css({left:"0",width:"100%"})}function f(){g.hide()}var g=$("#dimmer");return g.css({position:"fixed","z-index":1,width:"100%","background-color":"#000",top:0,left:0,display:"none"}),window.onresize=function(){a()},a(),{show:b,hide:c,contract:d,reset:e,destroy:f}}(),UI.Navigation=function(){$("[data-screen]").click(function(){var a=$(this).attr("data-screen"),b=new CustomEvent("navEvent",{detail:a});document.dispatchEvent(b)})}(),UI.Slideshow=function(){function a(a,c,d,e,f){return new b(a,c,d,e,f)}var b=function(a,b,c,d,e){function f(){var a=0;l.each(function(){var b=$(this);b.css({width:j.width()+"px",display:"block","float":"left",height:b.height()+"px"}),b.height()>a&&(a=b.height())}),k.css({width:l.length*j.width+"px",height:a+"px",position:"absolute",overflow:"hidden",top:0,left:0}),n.css({position:"absolute","z-index":"1000",right:"5%",top:"50%","margin-top":"-"+n.height()/2+"px"}),m.css({position:"absolute","z-index":"1000",left:"5%",top:"50%","margin-top":"-"+n.height()/2+"px"})}function g(){m.click(function(){h(-1)}),n.click(function(){h(1)})}function h(a){if(!p){p=!0;var b=$(l[o]);b.fadeTo("fast",0,function(){o+=a,0>o&&(o=l.length-1),o===l.length&&(o=0),b.hide();var c=$(l[o]);c.fadeTo("fast",1,function(){0===o&&m.fadeTo("fast",0,function(){m.hide()}),o===l.length-1&&n.fadeTo("fast",0,function(){n.hide()}),o>0&&m.fadeTo("fast",.8),o<l.length-1&&n.fadeTo("fast",.8),p=!1})})}}function i(){m.hide(),n.hide(),l.hide(),p=!0,o=0;var a=$(l[o]);a.fadeTo("fast",1,function(){p=!1,n.fadeTo("fast",1)})}var j,k,l,m,n,o,p;return j=$(a),k=j.find(b+":eq(0)"),l=k.children(c),m=j.find(d+":eq(0)"),n=j.find(e+":eq(0)"),f(),g(),i(),{reset:i}};return{build:a}}(),UI.ToggleButton=function(){function a(a,b,c,d,e,f){var g,h=$(a),i=h.find($(b)),j=h.find($(c)),k=d;g=(f=void 0)?g=e:(f=e)&&(g=k),h.data("toggle",f),j.hide(),h.fadeTo("fast",1),h.click(function(){var a=$(this);a.data("toggle")?(k(),i.hide(),j.show(),a.data("toggle",!1)):(g(),i.show(),j.hide(),a.data("toggle",!0))})}return{init:a}}(),UI.VideoPlayer=function(){function a(a,b){if(!h){h=!0,e=$(a),f=$(b);var d=document.createElement("script");d.type="text/javascript",d.async=!0,d.src=i;var g=document.getElementsByTagName("script")[0];g.parentNode.insertBefore(d,g),f.click(function(){c()}),e.hide()}}function b(a){"undefined"==typeof starzVideoPlayer2?setTimeout(function(){g++,3===g?d():b(a)},500):(_options={src:a,ccUri:"",poster:"img/poster.jpg",width:533,height:300,autoPlay:!0},starzVideoPlayer2.init(_options,!1),e.show(),STARZ.SoundManager.pause())}function c(){starzVideoPlayer2.stop(),e.hide(),STARZ.SoundManager.resume()}function d(){console.log("error")}var e,f,g=0,h=!1,i="http://assets.starz.com/starzvideoplayer/v1-patch30/JsLib/starzVideoPlayer2.js";return{init:a,playVideo:b,close:c}}(),STARZ.EventDispatcher=function(){function a(a,b){document.dispatchEvent(new CustomEvent(a,{detail:b}))}return{fire:a}}(),STARZ.JSONLoader=function(){function a(a,b,c){function d(a){b(a)}function e(b){c(b.status+", "+a+" "+b.statusText)}$.ajax({url:a,data:"json",success:d,error:e})}return{load:a}}(),STARZ.InControl=function(){function a(){UI.VideoPlayer.init("[data-video]","#closeVideo"),STARZ.GameStatusManager.reset(),STARZ.SoundManager.init("audio"),STARZ.SoundManager.addMusic("music1"),STARZ.SoundManager.addMusic("music2"),STARZ.SoundManager.addFX("fx1"),STARZ.SoundManager.addFX("fx2"),UI.ButtonFX.init(".button1"),b()}function b(){0===h?(STARZ.ScreenManager.showScreen("#loading"),STARZ.JSONLoader.load("data/images.json",c,g),STARZ.JSONLoader.load("data/quiz.json",d,g)):STARZ.ScreenManager.showScreen("#titleScreen")}function c(a){STARZ.TVManager.data(a),h++,e()}function d(a){STARZ.QuizManager.data(a),h++,e()}function e(){h===i&&(f(),STARZ.ScreenManager.showScreen("#titleScreen"))}function f(){STARZ.ScreenManager.bindMethod("#titleScreen",STARZ.Title.init),STARZ.ScreenManager.bindMethod("#instructionsScreen",STARZ.Instructions.init),STARZ.ScreenManager.bindMethod("#triviaScreen",STARZ.Quiz.init),STARZ.ScreenManager.bindMethod("#gameplayScreen",STARZ.Game.init),STARZ.ScreenManager.bindMethod("#summaryScreen",STARZ.Summary.init)}function g(a){a&&console.log("Error: "+a),console.log("Game crashed.")}var h=0,i=2;return{init:a,error:g}}(),STARZ.InControl.init();